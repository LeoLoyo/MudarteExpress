<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<div class="row">
    <div class="col-md-12">
      <h1>Resumen</h1>
      <div class="panel panel-default hidden">
        <div class="col-md-12"><h2>{{cliente.nombre}}</h2></div>
        <div class="panel-body">

        <h3>{{cliente.nombre}}</h3>
          <div class="col-md-12 col-lg-4">
            <p><strong>Email:</strong>
              {{cliente.email}}
            </p>
            <p><strong>Telefono:</strong>
               {{cliente.telefono}}
            </p>

          </div>
          <div class="col-md-12 col-lg-4">

          </div>
          <div class="col-md-12 col-lg-4">
            <p>
              <strong>N° Cotización: </strong>{{cotizacion.numero}}
            </p>
            <p>
              <strong>Responsable: </strong>{{cotizacion.responsable}}
            </p>
        </div>
        <p><strong>Dirección:</strong>{{cliente.direccion}}</p>
      </div>
    </div>
        <form class="formulario">
          <h2>Contenedores</h2>
          <table class="table table-bordered">
              <tr class="info">
                <th>Contenedor</th>
                <th style="width:80px; padding:10px;">Cantidad</th>
                <th style="width:80px; padding:10px; padding-left:30px;">m<sup>3</sup></th>
              </tr>
              <tr ng-repeat="item in contenedores_temp">
                <td>{{item.contenedor}}</td>
                <td align="center">{{item.unidad}}</td>
                <td align="center">{{item.punto/10|number:2}}</td>
              </tr>
              <tr class="active">
                <td><strong>Total</strong></td>
                <td align="center"><strong>{{unidades_contenedores}}</strong></td>
                <td align="center"><strong>{{metros3_contenedores|number:2}}</strong></td>
              </tr>
          </table>

          <h2>Muebles</h2>
          <table class="table table-bordered">
            <tr class="info">
              <th>Mueble</th>
              <th style="width:80px; padding:10px;">Dimension</th>
              <th style="width:80px; padding:10px;">Cantidad</th>
              <th style="width:80px; padding:10px; padding-left:30px;">m<sup>3</sup></th>
            </tr>
            <tr ng-repeat="item in muebles_temp">
              <td ng-if="item.mueble == 'Otros'">Otros-{{item.descripcion}}</td>
              <td ng-if="item.mueble != 'Otros'">{{item.mueble}}</td>
              <td align="center">{{item.ancho}}x{{item.largo}}x{{item.alto}}</td>
              <td align="center">{{item.cantidad}}</td>
              <td align="center">{{item.total_punto/10|number:2}}</td>
            </tr>
            <tr class="active">
              <td colspan="2"><strong>Total</strong></td>
              <td align="center"><strong>{{unidades_otros}}</strong></td>
              <td align="center"><strong>{{metros3_otros|number:2}}</strong></td>
            </tr>
          </table>

          <h2>Totales</h2>
          <table style="width:200px;" class="table table-bordered">
            <tr>
              <th class="info">Total m<sup>3</sup></th>
              <td align="center"><strong>{{metros3_contenedores+metros3_muebles+metros3_otros|number:2}}</strong></td>
            </tr>
          </table>
          <button type="submit" ng-disabled="otros_temp.length === 0 && contenedores_temp.length === 0 && muebles_temp.length === 0" class="btn btn-success" onclick="descargarExcel()" ng-click="save(cotizacion,cliente)">Exportar</button>
        </form>
    </div>

    <div id="divExportar" class="col-md-12 hidden">
        <h1>Resumen</h1>
            <!-- <table border=1 id="tablaTotal" class="hidden">
              <tr>
                <th style="background-color: #d9edf7">Nro. Cotizacion</th>
                <td>{{cotizacion.numero}}</td>
              </tr>
              <tr>
                <th style="background-color: #d9edf7">Cliente</th>
                <td>{{cliente.nombre}}</td>
              </tr>
              <tr>
                <th style="background-color: #d9edf7">Responsable</th>
                <td>{{cliente.responsable}}</td>
              </tr>
            </table> -->

            <table border=1 id="prueba">
              <tr>
                <th rowspan=4 colspan=6></th>
                <th>N° Cotiz.</th>
                <td></td>
              </tr>
              <tr>
                <th>Fuente</th>
                <td></td>
              </tr>
              <tr>
                <th>CP/PV</th>
                <td></td>
              </tr>
              <tr>
                <th>Particular</th>
                <td></td>
              </tr>
              <tr>
                <th align=left colspan=2>Nombre y apellido:</th>
                <td align=center colspan=4><strong>Pablo Amendola</strong></td>
                <th>Empresa</th>
                <td align=center></td>
              </tr>
              <tr>
                <th align=left colspan=2>Telefono:</th>
                <td align=center colspan=4></td>
                <th>Gobierno</th>
                <td align=center></td>
              </tr>
              <tr>
                <th align=left colspan=2>Correo electronico:</th>
                <td align=center colspan=4></td>
                <th>Cargo</th>
                <td align=center></td>
              </tr>
              <tr>
                <th align=left colspan=2>Fecha en que se encargo:</th>
                <td align=center colspan=2></td>
                <th>Hora:</th>
                <td align=center></td>
                <th>Cotizador</th>
                <td align=center></td>
              </tr>
              <tr>
                <th align=left colspan=2>Fecha estimada de mudanza:</th>
                <td align=center colspan=2></td>
                <th>Hora:</th>
                <td align=center></td>
                <th>Forma Pago</th>
                <td align=center></td>
              </tr>
              </table>
              <table border=1 >
              <tr>
                <th align=left colspan=2>Fecha en que se cotizo:</th>
                <td align=center colspan=2></td>
                <th>Hora:</th>
                <td align=center></td>
              </tr>
              <tr>
                <th align=left colspan=2>Fecha en que se aviso:</th>
                <td align=center colspan=2></td>
                <th>Hora:</th>
                <td align=center></td>
              </tr>
              <tr>
                <th align=left colspan=2>Fecha en que se cerro:</th>
                <td align=center colspan=2></td>
                <th>Hora:</th>
                <td align=center></td>
              </tr>
              <tr>
                <th align=left colspan=2>Fecha real de mudanza:</th>
                <td align=center colspan=2></td>
                <th>Hora:</th>
                <td align=center></td>
              </tr>
              <tr>
                <th align=left colspan=3>Nombre de quien paso la cotizacion:</th>
                <td align=center colspan=3></td>
              </tr>
              <tr>
                <th align=left colspan=3>Nombre de quien llamo al cliente:</th>
                <td align=center colspan=3></td>
              </tr>
              <tr>
                <th colspan=4>Domicilio de Origen:</th>
                <th colspan=2>Barrio/Provincia:</th>
              </tr>
              <tr>
                <td align=center rowspan=2 colspan=4></td>
                <td align=center rowspan=2 colspan=2></td>
              </tr>
              <tr></tr>
              <tr>
                <th colspan=6>Observaciones de Origen:</th>
              </tr>
              <tr>
                <td rowspan=4 colspan=6></td>
              </tr>
              <tr></tr>
              <tr></tr>
              <tr></tr>
              <tr>
                <th colspan=4>Domicilio de Destino:</th>
                <th colspan=2>Barrio/Provincia:</th>
              </tr>
              <tr>
                <td align=center colspan=4></td>
                <td align=center colspan=2></td>
              </tr>
              <tr>
                <th colspan=6>Observaciones de Destino:</th>
              </tr>
              <tr>
                <td rowspan=4 colspan=6></td>
              </tr>
              <tr></tr>
              <tr></tr>
              <tr></tr>
            </table>
            <br>
            <br>
            <br>
            <br>
            <table border=1>
              <tr>
                <th>Km</th>
                <td align=center></td>
                <td align=center></td>
                <td align=center></td>
                <th>Materiales</th>
                <th>Cantidad</th>
                <th>Precio unit.</th>
                <th>Totales</th>
                <th>Mudanza</th>
                <td align=center></td>
              </tr>
              <tr>
                <th>Tiempo de carga</th>
                <td align=center colspan=2></td>
                <td align=center></td>
                <th>Cajas Nuevas</th>
                <td align=center></td>
                <td align=center></td>
                <td align=center></td>
                <th>Soga</th>
                <td align=center></td>
              </tr>
              <tr>
                <th>Tiempo de descarga</th>
                <td align=center colspan=2></td>
                <td align=center></td>
                <th>Cajas Reciclables</th>
                <td align=center></td>
                <td align=center></td>
                <td align=center></td>
                <th>Embalaje</th>
                <td align=center></td>
              </tr>
              <tr>
                <th>Camion N°</th>
                <td align=center colspan=2></td>
                <td align=center></td>
                <th>Streech</th>
                <td align=center></td>
                <td align=center></td>
                <td align=center></td>
                <th>Desembalaje</th>
                <td align=center></td>
              </tr>
              <tr>
                <th>Ayudantes</th>
                <td align=center colspan=2></td>
                <td align=center></td>
                <th>Pluriball</th>
                <td align=center></td>
                <td align=center></td>
                <td align=center></td>
                <th>Materiales</th>
                <td align=center></td>
              </tr>
              <tr>
                <th>Seguro</th>
                <td align=center colspan=2></td>
                <td align=center></td>
                <th>Corrugado</th>
                <td align=center></td>
                <td align=center></td>
                <td align=center></td>
                <th>Piano/C.fuerte</th>
                <td align=center></td>
              </tr>
              <tr>
                <th>Desarme de Muebles</th>
                <td align=center colspan=2></td>
                <td align=center></td>
                <th>Cintas</th>
                <td align=center></td>
                <td align=center></td>
                <td align=center></td>
                <th>Ajuste</th>
                <td align=center></td>
              </tr>
              <tr>
                <th>Ambientes</th>
                <td align=center colspan=2></td>
                <td align=center></td>
                <th>Papel Sulfito</th>
                <td align=center></td>
                <td align=center></td>
                <td align=center></td>
                <th>IVA</th>
                <td align=center></td>
              </tr>
              <tr>
                <th>Rampa</th>
                <td align=center></td>
                <td align=center></td>
                <td align=center></td>
                <th>Bolsas</th>
                <td align=center></td>
                <td align=center></td>
                <td align=center></td>
                <th>Total</th>
                <td style="background-color: #d9edf7;" align=center></td>
              </tr>
            </table>


          <h2>Contenedores</h2>
            <legend></legend>
            <table border=1 id="tablaContenedor">
              <tr>
                <th style="background-color: #d9edf7;">Contenedor</th>
                <th style="background-color: #d9edf7;">Cantidad</th>
                <th style="background-color: #d9edf7;">m<sup>3</sup></th>
              </tr>
              <tr ng-repeat="item in contenedores_temp">
                <td>{{item.contenedor}}</td>
                <td>{{item.unidad}}</td>
                <td>{{item.punto/10|number:2}}</td>
              </tr>
              <tr style="background-color: #f5f5f5">
                <th class="estiloUno">Total</th>
                <td><strong>{{unidades_contenedores}}</strong></td>
                <td><strong>{{metros3_contenedores|number:2}}</strong></td>
              </tr>
            </table>

            <h2>Muebles</h2>
            <legend></legend>
            <table border=1 id="tablaMueble">
              <tr>
                <th style="background-color: #d9edf7">Mueble</th>
                <th style="background-color: #d9edf7">Dimension</th>
                <th style="background-color: #d9edf7">Cantidad</th>
                <th style="background-color: #d9edf7">m<sup>3</sup></th>
              </tr>
              <tr ng-repeat="item in muebles_temp">
                <td ng-if="item.mueble == 'Otros'">Otros-{{item.descripcion}}
                <td ng-if="item.mueble != 'Otros'">{{item.mueble}}</td>
                <td>{{item.ancho}}x{{item.largo}}x{{item.alto}}</td>
                <td>{{item.cantidad}}</td>
                <td>{{item.total_punto/10|number:2}}</td>
              </tr>
              <tr style="background-color: #f5f5f5">
              <th colspan="2" class="estiloUno">Total</th>
              <td><strong>{{unidades_otros}}</strong></td>
              <td><strong>{{metros3_otros|number:2}}</strong></td>
              </tr>
            </table>

            <h2>Totales</h2>
            <legend></legend>
            <table border=1 id="tablaTotal">
              <tr>
                <th style="background-color: #d9edf7">Total m<sup>3</sup></th>
                <th><strong>{{metros3_contenedores+metros3_muebles+metros3_otros|number:2}}</strong></th>
              </tr>
            </table>
    </div>
</div>

<script>
function descargarExcel(){
        var tmpElemento = document.createElement('a');
        var data_type = 'data:application/vnd.ms-excel; charset=utf-8';
        var tabla_div = document.getElementById('divExportar');
        var tabla_html = tabla_div.outerHTML.replace(/ /g, '%20');
        tmpElemento.href = data_type + ', ' + tabla_html;
        //Asignamos el nombre a nuestro EXCEL
        tmpElemento.download = 'Resumen.xls';
        tmpElemento.click();
    }
</script>
