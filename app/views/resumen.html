<div class="row">
    <div class="col-md-12">
      <h1>Resumen</h1>
      <div class="panel panel-default">
        <div class="panel-body">

        <h2>Pedro Perez</h2>
          <div class="col-md-12 col-lg-4">
            <p>
              <small><strong>Email:</strong></small>
              pedro@gmail.com
            </p>
            <p>
              <small><strong>Telefono:</strong></small>
               0412-8892515
            </p>

          </div>
          <div class="col-md-12 col-lg-4">

          </div>
          <div class="col-md-12 col-lg-4">
            <p>
              <strong>N° Cotización: </strong>00026
            </p>
            <p>
              <strong>Responsable: </strong>Admin
            </p>
        </div>
        <p><strong>Dirección:</strong>xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</p>
      </div>
    </div>
        <form class="formulario">
          <h2>Contenedores</h2>
          <table class="table table-bordered">
              <tr class="info">
                <th>Contenedor</th>
                <th style="width:80px; padding:10px;">Cantidad</th>
                <th style="width:80px; padding:10px; padding-left:30px;">m<sup>3</sup></th>
              </tr>
              <tr ng-repeat="item in contenedores_temp">
                <td>{{item.contenedor}}</td>
                <td>{{item.unidad}}</td>
                <td>{{item.punto/10}}</td>
              </tr>
              <tr class="active">
                <td><strong>Total</strong></td>
                <td><strong>{{unidades_contenedores}}</strong></td>
                <td><strong>{{metros3_contenedores}}</strong></td>
              </tr>
          </table>

          <h2>Muebles</h2>
          <table class="table table-bordered">
            <tr class="info">
              <th>Mueble</th>
              <th style="width:80px; padding:10px;">Cantidad</th>
              <th style="width:80px; padding:10px; padding-left:30px;">m<sup>3</sup></th>
            </tr>
            <tr ng-repeat="item in muebles_temp">
              <td>{{item.mueble}}</td>
              <td>{{item.cantidad}}</td>
              <td>{{item.punto/10}}</td>
            </tr>
            <tr class="active">
              <td><strong>Total</strong></td>
              <td><strong>{{unidades_muebles}}</strong></td>
              <td><strong>{{metros3_muebles}}</strong></td>
            </tr>
          </table>

          <h2>Otros</h2>
          <table class="table table-bordered">
            <tr class="info">
              <th>Descripcion</th>
              <th style="width:80px; padding:10px;">Cantidad</th>
              <th style="width:80px; padding:10px; padding-left:30px;">m<sup>3</sup></th>
            </tr>
            <tr ng-repeat="item in otros_temp">
              <td ng-if="item.mueble == 'Otro'">Otro-{{item.mueble}}</td>
              <td ng-if="item.mueble != 'Otro'">{{item.mueble}}</td>
              <td>{{item.cantidad}}</td>
              <td>{{item.punto/10}}</td>
            </tr>
            <tr class="active">
              <td><strong>Total</strong></td>
              <td><strong>{{unidades_otros}}</strong></td>
              <td><strong>{{metros3_otros}}</strong></td>
            </tr>
          </table>

          <h2>Totales</h2>
          <table style="width:200px;" class="table table-bordered">
            <tr>
              <th style="padding:10px; padding-left:30px;" class="info">Total Contenido</th>
              <td><strong>{{unidades_contenedores+unidades_muebles+unidades_otros}}</strong></td>
            </tr>
            <tr>
              <th style="padding:10px; padding-left:30px;" class="info">Total m<sup>3</sup></th>
              <td><strong>{{metros3_contenedores+metros3_muebles+metros3_otros}}</strong></td>
            </tr>
          </table>
          <!-- <button type="submit" class="btn btn-success" onclick="descargarExcel()" ng-click="save(cotizacion,cliente)">Exportar</button> -->
          <button type="submit" class="btn btn-success"  ng-click="descargarExcel()">Exportar</button>
        </form>
    </div>

    <div id="divExportar" class="col-md-12 hidden">
        <h1>Resumen</h1>
            <table border=1 id="tablaTotal">
              <tr>
                <th style="background-color: #d9edf7">Nro. Cotizacion</th>
                <td>COT0050</td>
              </tr>
              <tr>
                <th style="background-color: #d9edf7">Cliente</th>
                <td>Pedro Perez</td>
              </tr>
              <tr>
                <th style="background-color: #d9edf7">Responsable</th>
                <td>Admin</td>
              </tr>
            </table>

          <h2>Contenedores</h2>
            <legend></legend>
            <table border=1 id="tablaContenedor">
              <tr>
                <th style="background-color: #d9edf7;">Contenedor</th>
                <th style="background-color: #d9edf7;">Cantidad</th>
                <th style="background-color: #d9edf7;">m<sup>3</sup></th>
              </tr>
              <tr ng-repeat="item in contenedores_temp">
                <td>{{item.contenedor}}</td>
                <td>{{item.unidad}}</td>
                <td>{{item.punto/10}}</td>
              </tr>
              <tr style="background-color: #f5f5f5">
                <th class="estiloUno">Total</th>
                <td><strong>{{unidades_contenedores}}</strong></td>
                <td><strong>{{metros3_contenedores}}</strong></td>
              </tr>
            </table>

            <h2>Muebles</h2>
            <legend></legend>
            <table border=1 id="tablaMueble">
              <tr>
                <th style="background-color: #d9edf7">Mueble</th>
                <th style="background-color: #d9edf7">Cantidad</th>
                <th style="background-color: #d9edf7">m<sup>3</sup></th>
              </tr>
              <tr ng-repeat="item in muebles">
                <td>{{item.mueble}}</td>
                <td>{{item.cantidad}}</td>
                <td>{{item.punto/10}}</td>
              </tr>
              <tr style="background-color: #f5f5f5">
                <th class="estiloUno">Total</th>
              <td><strong>{{unidades_muebles}}</strong></td>
              <td><strong>{{metros3_muebles}}</strong></td>
              </tr>
            </table>

            <h2>Otros</h2>
            <legend></legend>
            <table border=1 id="tablaOtro">
              <tr>
                <th style="background-color: #d9edf7">Descripcion</th>
                <th style="background-color: #d9edf7">Cantidad</th>
                <th style="background-color: #d9edf7">m<sup>3</sup></th>
              </tr>
              <tr ng-repeat="item in otros">
                <td>{{item.descripcion}}</td>
                <td>{{item.cantidad}}</td>
                <td>{{item.punto/10}}</td>
              </tr>
              <tr style="background-color: #f5f5f5">
                <th class="estiloUno">Total</th>
              <td><strong>{{unidades_otros}}</strong></td>
              <td><strong>{{metros3_otros}}</strong></td>
              </tr>
            </table>

            <h2>Totales</h2>
            <legend></legend>
            <table border=1 id="tablaTotal">
              <tr>
                <th style="background-color: #d9edf7">Total Contenido</th>
                <td><strong>{{unidades_contenedores}}+{{unidades_muebles}}+{{unidades_otros}}</strong></td>
              </tr>
              <tr>
                <th style="background-color: #d9edf7">Total m<sup>3</sup></th>
                <td><strong>{{metros3_contenedores}}+{{metros3_muebles}}+{{metros3_otros}}</strong></td>
              </tr>
            </table>
    </div>
</div>

<script>
function descargarExcel(){
        var tmpElemento = document.createElement('a');
        var data_type = 'data:application/vnd.ms-excel';
        var tabla_div = document.getElementById('divExportar');
        var tabla_html = tabla_div.outerHTML.replace(/ /g, '%20');
        tmpElemento.href = data_type + ', ' + tabla_html;
        //Asignamos el nombre a nuestro EXCEL
        tmpElemento.download = 'Resumen.xls';
        tmpElemento.click();
    }
</script>
